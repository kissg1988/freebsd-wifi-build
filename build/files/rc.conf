# Set the default system hostname
system_hostname="@DEF_HOSTNAME@"

# Services to start
services_list="dropbear dnsmasq"

# These interfaces are configured in-order
network_interfaces="etherswitch0 @DEF_ETH@ bridge0 WAN"

# switch configuration
netif_etherswitch0_enable="@DEF_SWITCH_ENABLE@"
if [ "${netif_etherswitch0_enable}" = "YES" ]
then
    netif_etherswitch0_type="etherswitch"
    netif_etherswitch0_mode="dot1q"
    netif_etherswitch0_name="etherswitch0"
    netif_etherswitch0_descr="on-board ethernet switch"
    netif_etherswitch0_portlist="@DEF_SWITCH_PORTLIST@"
    netif_etherswitch0_pvidlist="@DEF_SWITCH_PVIDLIST@"
    netif_etherswitch0_vlangrouplist="0 1"
    netif_etherswitch0_vlangroup0_vid="1"
    netif_etherswitch0_vlangroup0_members="@DEF_SWITCH_G0_MEMBERS@"
    netif_etherswitch0_vlangroup1_vid="2"
    netif_etherswitch0_vlangroup1_members="@DEF_SWITCH_G1_MEMBERS@"
    set ${netif_etherswitch0_pvidlist}
    for i in ${netif_etherswitch0_portlist}; do
        netif_etherswitch0_port${i}_pvid="$1"; shift
    done
fi

# Create @DEF_ETH@, no interface address
netif_@DEF_ETH@_enable="YES"
netif_@DEF_ETH@_type="ether"
netif_@DEF_ETH@_addrtype="none"
netif_@DEF_ETH@_descr="default"
netif_@DEF_ETH@_name="@DEF_ETH@"

# Create a bridge, flip on an IPv4 static address
netif_bridge0_type="bridge"
netif_bridge0_addrtype="static"
netif_bridge0_descr="default"
netif_bridge0_name="bridge0"

# These are bridge members w/ STP enabled
netif_bridge0_members_stp="@DEF_ETH@"
# These are bridge members w/ STP disabled
netif_bridge0_members=""
netif_bridge0_ipv4_address="192.168.1.1"
netif_bridge0_ipv4_netmask="255.255.255.0"

# Create WAN interface, get address with DHCP
netif_WAN_enable="@DEF_WAN_ENABLE@"
netif_WAN_type="@DEF_WAN_TYPE@"
netif_WAN_vlanid="@DEF_WAN_VLANID@"
netif_WAN_parent="@DEF_WAN_PARENT@"
netif_WAN_addrtype="dhcp"
netif_WAN_descr="WAN"
netif_WAN_name="@DEF_WAN@"

# Configure firewall
firewall_nat_enable="@DEF_FW_NAT_ENABLE@"
firewall_nat_alias_interface="@DEF_WAN@"
firewall_nat_public_interface="@DEF_WAN@"
firewall_nat_deny_in="NO"
firewall_nat_same_ports="YES"

# Enable IP packet forwarding
forwarding_enable="@DEF_FORWARDING_ENABLE@"

# Modules to load
kernel_modules="random bridgestp if_bridge ipfw"
if [ "${netif_WAN_type}" = "vlan" ] && \
	kernel_modules="${kernel_modules} if_vlan"
if [ "${firewall_nat_enable}" = "YES" ] && \
	kernel_modules="${kernel_modules} ipfw_nat"

# Bind dropbear to LAN address only
dropbear_listen_address="${netif_bridge0_ipv4_address}:22"
dropbear_cmd_options="-R -B"

# Dnsmasq settings
dnsmasq_enable="@DEF_DNSMASQ_ENABLE@"
dnsmasq_dns_enable="YES"
dnsmasq_listen_interface="bridge0"
dnsmasq_domain_name="local"
dnsmasq_dhcp_ipv4_range="192.168.1.100,192.168.1.150,12h"
dnsmasq_no_dhcp_interface="@DEF_WAN@"
