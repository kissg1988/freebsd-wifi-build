# Set the default system hostname
system_hostname="@DEF_HOSTNAME@"

# Services to start
services_list="dropbear dnsmasq"

# Modules to load
kernel_modules="random bridgestp if_bridge if_vlan ipfw ipfw_nat"

# These interfaces are configured in-order
network_interfaces="etherswitch0 @DEF_ETH@ bridge0 arge0_2"

# switch configuration
netif_etherswitch0_enable="YES"
netif_etherswitch0_type="etherswitch"
netif_etherswitch0_mode="dot1q"
netif_etherswitch0_name="etherswitch0"
netif_etherswitch0_descr="on-board ethernet switch"
netif_etherswitch0_portlist="0 1 2 3 4 5"
netif_etherswitch0_vlangrouplist="0 1"
netif_etherswitch0_vlangroup0_vid="1"
netif_etherswitch0_vlangroup0_members="1,2,3,4,5"
netif_etherswitch0_vlangroup1_vid="2"
netif_etherswitch0_vlangroup1_members="0,5t"
netif_etherswitch0_port0_pvid="2"
netif_etherswitch0_port1_pvid="1"
netif_etherswitch0_port2_pvid="1"
netif_etherswitch0_port3_pvid="1"
netif_etherswitch0_port4_pvid="1"
netif_etherswitch0_port5_pvid="1"

# Create @DEF_ETH@, no interface address
netif_@DEF_ETH@_enable="YES"
netif_@DEF_ETH@_type="ether"
netif_@DEF_ETH@_addrtype="none"
netif_@DEF_ETH@_descr="default"
netif_@DEF_ETH@_name="@DEF_ETH@"

# Create a bridge, flip on an IPv4 static address
netif_bridge0_type="bridge"
netif_bridge0_addrtype="static"
netif_bridge0_descr="default"
netif_bridge0_name="bridge0"

# These are bridge members w/ STP enabled
netif_bridge0_members_stp="@DEF_ETH@"
# These are bridge members w/ STP disabled
netif_bridge0_members=""
netif_bridge0_ipv4_address="192.168.1.1"
netif_bridge0_ipv4_netmask="255.255.255.0"

# Create arge0.2, get address with DHCP
netif_arge0_2_enable="YES"
netif_arge0_2_type="vlan"
netif_arge0_2_vlanid="2"
netif_arge0_2_parent="arge0"
netif_arge0_2_addrtype="dhcp"
netif_arge0_2_descr="WAN"
netif_arge0_2_name="arge0.2"

# Enable IP packet forwarding
forwarding_enable="YES"

# Configure firewall
firewall_nat_enable="YES"
firewall_nat_alias_interface="arge0.2"
firewall_nat_public_interface="arge0.2"
firewall_nat_deny_in="YES"
firewall_nat_same_ports="YES"

# Bind dropbear to LAN address only
dropbear_listen_address="${netif_bridge0_ipv4_address}:22"
dropbear_cmd_options="-R -B"

# Dnsmasq settings
dnsmasq_enable="YES"
dnsmasq_dns_enable="YES"
dnsmasq_listen_interface="bridge0"
dnsmasq_domain_name="local"
dnsmasq_dhcp_ipv4_range="192.168.1.100,192.168.1.150,12h"
dnsmasq_no_dhcp_interface="arge0.2"
